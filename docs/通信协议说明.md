# 通信说明


## 协议说明
### 请求
|-------------------------------------------------    
|   A  |  B  |  C |  D |  E | F |    
|------------------------------------------------    

| 占位  | 字节长度 |        说明           |
| -------- | -------------- | ----------------------- |
| A       | 4字节      |  数据整体长度  |
| B       | 1字节      | 是否启用压缩   |
| C       | 1字节      | 加密描述符       |
| D       | 4字节      | 信息头长度       |
| E       |  D描述大小     | 消息头数据       |
| F       |  A大小 - 4 -1-1 -4-D大小     | 请求数据       |

消息头包含方法名称和参数

c=login&r=1&o=2&t=147364928384

后续是通信信息   
c : 请求方法
r  : 是否为重试   
o : 请求序号，自增    
t  : 时间戳    
token:授权信息    
lang:客户端请求语言 参考[区域设置](https://zh.wikipedia.org/wiki/%E5%8C%BA%E5%9F%9F%E8%AE%BE%E7%BD%AE)    
format :期望消息返回格式     


请求数据格式   
类似httpGET方式,做好encode编码    

username=xxx&password=xxx   

>Token格式

```chsarp
message Token {
   optional int32 Did = 1 [default = 0];  //服ID
   optional int64 Rid = 2 [default = 0];  //角色ID
   optional int64 Ts = 3 [default = 0];   //时间戳
   optional string Sign = 4;              //签名
   optional string Uid = 6;               //UID
}
```

### 返回
|-------------------------------------------------    
|   A  |  B  |  C |  D |  E |  F    
|------------------------------------------------                

| 占位  | 字节长度 |        说明           |
| -------- | -------------- | ----------------------- |
| A       | 4字节      |  数据整体长度  |
| B       | 1字节      | 是否启用压缩   |
| C       | 1字节      | 加密描述符       |
| D       | 4字节      | 消息头长度       |
| E       |  D描述大小     | 消息头数据       |
| F       |  A大小 - 4 -1-1 -4-D大小     | 请求数据       |

信息头   
c=login&r=1&o=2   
c : 方法名     
i : 消息类型 (1:返回  2广播)   
o : 请求序号，自增    
t  : 时间戳  
format:消息格式，默认protobuf, 其他可选json 和 text     
code:状态码 200以外都是错误异常        
errorCode:（ * ） 错误消息码    
errorMsg : （ * ） 错误消息
responsetype (*) protobuf的情况下告知客户端对应的描述   


返回数据   
可以按照需要定义好数据格式   
例如JSON 或者 protobuf